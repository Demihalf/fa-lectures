\section{Элементы нелинейного анализа}
\subsection{Производная отображения}
Всюду далее $X, Y$ --- банаховы пространства над $\fieldk \in \menge{\fieldc, \fieldr}$,
буквами $U$ и $V$ обозначаются открытые множества в $X$ и $Y$.

\begin{definition}
    Пусть $f \colon U \subset X \to Y$, $g \colon U \subset X \to \fieldr$, $x_0 \in U$.
    Говорят, что 
    \[f(x) = o(g(x)) \text{ при } x \to x_0, \] 
    если справедливо равенство
    \[ \norm{f(x)} = \varepsilon(x) g(x), \]
    где $\varepsilon \colon U \subset X \to \fieldr$, $\varepsilon(x) \to 0$ при $x \to x_0$.
\end{definition}

\begin{definition}
    Пусть $f, g \colon U \subset X \to Y$ --- отображения, определенные на открытом множестве
    $U$ из пространства $X$. Отображение $g$ называется \emph{касательным} к $f$ 
    в точке $x_0 \in U$, если
    \[ f(x) = g(x) + o(\norm{x - x_0}) \quad \text{при } x \to x_0, \]
    то есть
    \[ \frac{\norm{f(x) - g(x)}}{\norm{x - x_0}} \to 0 \quad \text{при } x \to x_0, \]
\end{definition}

Легко видеть, что <<$f$ касательно $g$>> есть отношение эквивалентности.

\begin{definition}
    Отображение $f \colon U \subset X \to Y$ называется \emph{дифференцируемым} в точке $x_0$,
    если существует такой оператор $A \in L(X, Y)$, что $f$ касательно $g$ в точке $x_0$, где
    $g$ определено по формуле
    \[ g(x) = f(x_0) + A(x - x_0), \quad x \in U. \]

    Иначе говоря, $f$ дифференцируемо в точке $x_0$ если
    \[ f(x) = f(x_0) + A(x - x_0) + o(\norm{x - x_0}) \quad \text{ при } x \to x_0. \]

    Если $f$ дифференцируемо в каждой точке $U$, то $f$ называют \emph{дифференцируемым}.

    Оператор $A$ называется \emph{производной} отображения $f$ в точке $x_0$. При этом используется
    привычное обозначение:
    \[ f'(x_0) = A. \]

    Также пишут $Df(x_0), D_{x_0}f$ и т. д.
\end{definition}

\begin{theorem}
    Определение производной корректно: линейный оператор $A$ определён однозначно 
    для каждой точки $x_0$.
\end{theorem}

\begin{proof}
    Пусть $f \colon U \subset X \to Y$ дифференцируемо в точке $x_0$. Тогда
    $f$ касательно $g$ в точке $x_0$, где $g(x) = f(x_0) + A(x - x_0)$.
    Пусть теперь $g_0(x) = f(x_0) + B(x-x_0)$, $B \in L(X, Y)$,
     также касательно к $f$ в точке $x_0$.
    Тогда $g_0$ касательно $g$ в точке $x_0$:
    \[ g(x) - g_0(x) = (A-B)(x - x_0), \]
    причем
    \[ g(x) - g_0(x) = o(\norm{x - x_0}). \]
    Примем обозначение $h = x - x_0$. Тогда
    \[ (A - B)h = o(\norm{h}). \]
    Раскрывая определение символа <<$o$>> получаем, что для всякого $\varepsilon > 0$
    существует такое $\delta$, что если $\norm{h} < \delta$, то 
    \[ \norm{(A-B)\frac{h}{\norm{h}}} < \varepsilon, \quad \norm{h} < \delta. \]
    Тогда
    \[ \sup_{\norm{h} < \delta} \norm{(A-B)\frac{h}{\norm{h}}} 
        = \sup_{\norm{x} \leq 1} \norm{(A-B)x} = \norm{A-B} < \varepsilon, \]
    откуда, в силу произвольности $\varepsilon$ получаем, что $A = B$.
\end{proof}

\begin{theorem}
    Пусть $f, g \colon U \subset X \to Y$ дифференцируемы в точке $x_0$. Тогда
    $\alpha f + \beta g$ также дифференцируемо в точке $x_0$, причем
    \[ (\alpha f + \beta g)'(x_0) = \alpha f'(x_0) + \beta g'(x_0). \]

    При этом производная линейной комбинации функций есть линейная комбинация производных.
\end{theorem}

\begin{proof}
    Отображения $f$, $g$ дифференцируемы в точке $x_0$, значит
    \begin{alignat*}{6}
        f(x) &= f(x_0) \; &+& \; f'(x_0)(x - x_0) \; &+& \; o(\norm{x-x_0}), \\
        g(x) &= g(x_0) \; &+& \; g'(x_0)(x - x_0) \; &+& \; o(\norm{x-x_0}).
    \end{alignat*}
    Домножая эти равенства на $\alpha$ и $\beta$ соответственно и сложив, получаем, в силу
    свойств символа <<$o$>>:
    \begin{multline*}
        (\alpha f + \beta g)(x) = (\alpha f + \beta g)(x_0) \, + \\ +
            (\alpha f'(x_0) + \beta g'(x_0))(x - x_0) + o(\norm{x-x_0}),
    \end{multline*}
    то есть, в силу корректности определения производной,
    \[ (\alpha f + \beta g)'(x_0) = \alpha f'(x_0) + \beta g'(x_0). \]
\end{proof}

Следующие две теоремы предлагаются в качестве упражнения.

\begin{theorem}
    Если $f \colon X \to Y$ --- постоянное отображение, то $f$ дифференцируемо
    в любой точке пространства $X$, причем $f'(x) = \mathbf 0$ 
    в любой точке $x \in X$.
\end{theorem}

\begin{theorem}
    Если $A \in L(X, Y)$, то отображение $A$
    дифференцируемо в любой точке $x \in X$ и $A'(x) = A$.
\end{theorem}

\begin{theorem}
    Пусть $f \colon U \subset X \to Y$ дифференцируемо в точке $x_0 \in U$, а
    $g \colon V \subset Y \to Z$ дифференцируемо в точке $y_0 = f(x_0)$
    и $f(U) \subset V$. Тогда отображение $F = g \circ f \colon U \subset X \to Z$
    дифференцируемо в точке $x_0$ и
    \[ F'(x_0) = g'(f(x_0)) f'(x_0) \in L(X, Z). \]
\end{theorem}

\begin{proof}
    Рассмотрим приращение отображения $F$:
    \begin{multline*}
        F(x) - F(x_0) = g(f(x)) - g(f(x_0)) = \\
         = g'(f(x_0))(f(x) - f(x_0)) + o(\norm{f(x) - f(x_0)}) = \\
         = g'(f(x_0))(f'(x_0)(x - x_0) + o(\norm{x - x_0})) + o(\norm{f(x) - f(x_0)}) = \\
         = g'(f(x_0))f'(x_0)(x - x_0) +\\+ g'(f(x_0))o(\norm{x - x_0}) + o(\norm{f(x) - f(x_0)})
    \end{multline*}
    Покажем, что 
    \[ g'(f(x_0))o(\norm{x - x_0}) + o(\norm{f(x) - f(x_0)}) = o(\norm{x - x_0}) \]
    при $x \to x_0$. Введем для краткости замену $h = x - x_0$. Тогда, с учетом того, что
    \[ \lim_{h \to 0}\frac{\norm{f(x_0+h) - f(x_0)}}{\norm{h}} \leq f'(x_0), \]
    получаем
    \begin{multline*}
        \frac{\norm{g'(f(x_0))o(\norm{h}) + o(\norm{f(x_0+h) - f(x_0)})}}{\norm{h}} \leq \\
        \leq \frac{\norm{g'(f(x_0))}\norm{o(\norm{h})} 
          + \norm{o(\norm{f(x_0+h) - f(x_0)})}}{\norm{h}} = \\
        = \frac{\norm{g'(f(x_0))}\varepsilon_1(h)\norm{h} 
          + \varepsilon_2(h)\norm{f(x_0+h) - f(x_0)}}{\norm{h}} = \\
        = \norm{g'(f(x_0))}\varepsilon_1(h) 
          + \frac{\varepsilon_2(h)\norm{f(x_0+h) - f(x_0)}}{\norm{h}} \to 0 \text{ при } h \to 0.
    \end{multline*}
    Таким образом
    \[ F(x) - F(x_0) = g'(f(x_0))f'(x_0)(x - x_0) + o(\norm{x - x_0}) \text{ при } x \to x_0. \]
\end{proof}

См. <<Лекции по алгебре>> для определения полилинейного (билинейного) оператора.

\begin{definition}
    Билинейный оператор $A \colon X \times X \to Y$ называется \emph{ограниченным}, если
    \[ \norm{A} = \sup_{\norm{x_1} \leq 1, \; \norm{x_2} \leq 1} \norm{A(x_1, x_2)} < \infty. \]
\end{definition}
Символом $B_2(X, Y)$ будем обозначать нормированное пространство 
билинейных ограниченных операторов, действующих из $X \times X$ в $Y$.

Аналогично определяется полилинейный ограниченный оператор. Пространство $n$-линейных
ограниченных операторов обозначается $B_n(X, Y)$.

\begin{theorem}
    Пространство операторов $L(X, L(X, Y))$ и пространство
    билинейных операторов $B_2(X, Y)$ изометрически изоморфны.
\end{theorem}

\begin{proof}
    Пусть отображение 
    \[ J \colon L(X, L(X, Y)) \to B_2(X, Y) \] 
    действует по правилу
    \[ (JA)(x_1, x_2) = (Ax_1)x_2. \]
    Очевидно, это линейный оператор между $L(X, L(X, Y))$ и $B_2(X, Y)$.
    Биективность проверяется непосредственно. Проверим изометричность:
    \begin{multline*}
        \norm{JA}_{B_2(X, Y)} = 
        \sup_{\norm{x_1} \leq 1, \; \norm{x_2} \leq 1} \norm{(Ax_1)x_2}_{Y} = \\ = 
            \sup_{\norm{x_1} \leq 1}(\sup_{\norm{x_2} \leq 1} \norm{(Ax_1)x_2}_{Y})  =
            \sup_{\norm{x_1} \leq 1}(\norm{Ax_1}_{L(X, Y)}) = \\ = \norm{A}_{L(X, L(X, Y))}.
    \end{multline*}
\end{proof}

Аналогичный результат справедлив для полилинейных операторов:
\begin{theorem}\hfill\\
    \indent Пространства $L(\underbrace{X, L(X, \dotsc, L(X}_{n\text{ раз}}, Y)))$ и 
    $B_n(X, Y)$ изометрически изоморфны.
\end{theorem}

Из этих теорем, в частности, следует, что $B_n(X, Y)$ --- банахово пространство, если
$Y$ банахово.

\begin{definition}
    Пусть $f \colon U \subset X \to Y$ дифференцируемо в каждой точке $U$ и отображение
    $f' \colon U \subset X \to L(X, Y)$ дифференцируемо в точке $x_0$. Тогда \emph{второй
    производной} отображения $f$ в точке $x_0$ называется производная отображения $f'$ в точке
    $x_0$.
\end{definition}

Таким образом, вторая производная отображения $f$ в точке $x_0$ есть линейный оператор 
$f''(x_0) \in L(X, L(X, Y))$, или, в силу предыдущей теоремы, вторую производную 
можно считать билинейным оператором из $B_2(X, Y)$.

Аналогично определяется $n$-ая производная отображения $f$ в точке $x_0$. Тогда
$f^{(n)}(x_0) \in B_n(X, Y)$.

\begin{definition}
    Отображение $f \colon U \subset X \to Y$ называется \emph{$n$ раз непрерывно дифференцируемым},
    если для каждого $k = \overline{1,n}$ существует $k$-ая производная $f^{(k)}(x)$, определенная
    для всех $x \in U$ и при этом отображение $f^{(n)} \colon U \subset X \hm\to B_n(X, Y)$ 
    непрерывно.
\end{definition}

Пусть $A \in B_n(X, Y)$. Введём следующее обозначение:
\[ Ah^n := A(h, \dotsc, h). \]

Договоримся также, что $f^{(0)}(x) = f(x)$ для всех $x \in U$, и $h^0 = 1 \in \fieldk$.

\begin{theorem}[Тейлора]
    Пусть отображение $f \colon U \subset X \to Y$ $n$ раз непрерывно дифференцируемо. 
    Тогда для любой точки $x_0 \in U$ и любого вектора $h$ такого, что $x_0 + h \in U$,
    имеет место формула (Тейлора): 
    \[ f(x_0 + h) = \sum_{k = 0}^n \frac{f^{(k)}(x_0)h^k}{k!} + o(\norm{h}^n) 
        \text{ при } h \to 0. \]
\end{theorem}

\subsection{Задачи на экстремум}
\begin{definition}
    Точка $x_0 \in U$ называется \emph{точкой локального минимума (максимума)} функции 
    $f \colon U \subset X \to \fieldr$, если существует шар 
    $B(x_0, \varepsilon) \subset U$ такой, что
    $f(x_0) \leq f(x)$ ($f(x_0) \geq f(x)$) для всех $x \in B(x_0, \varepsilon)$. 
    Если же выполняется строгое неравенство, то точка $x_0$ называется 
    \emph{точкой строгого локального минимума (максимума)}.

    Точка, являющаяся точкой (строгого) локального минимума либо максимума, также называется 
    \emph{точкой (строгого) локального экстремума}.
\end{definition}

\begin{theorem}[Ферма]
    Пусть $f \colon U \subset X \to \fieldr$ --- дифференцируемая в точке $x_0$ функция и
    $x_0 \in U$ --- точка локального экстремума. Тогда $f'(x_0) = 0$, то есть $f'(x_0) \in X^*$ 
    --- нулевой функционал.
\end{theorem}

\begin{proof}
    Пусть, для определенности, $x_0$ --- точка локального минимума (случай локального максимума
    рассматривается аналогично), и для всех $h \in X$ таких, что $\norm{h} < \varepsilon$ 
    выполняется условие $f(x_0 + h) \geq f(x_0)$.

    Предположим противное: пусть $f'(x_0) \neq 0$. Тогда найдется такой вектор $h_0$, 
    $\norm{h_0} < \varepsilon$, что $\alpha_0 = f'(x_0)h_0 > 0$. Пусть 
    $t \in (-1, 0) \subset \fieldr$.
    Тогда, разумеется, $\norm{t h_0} < \varepsilon$ и $f'(x_0)(th_0) < 0$.
    В силу дифференцируемости функции в точке $x_0$ справедливо равенство
    \[ f(x_0 + t h_0) - f(x_0) = f'(x_0)(th_0) + o(t). \]
    Тогда
    \[ 0 \leq f(x_0 + t h_0) - f(x_0) = f'(x_0)(t h_0) + o(t) = t \left( \alpha_0 +
         \frac{o(t)}{t} \right). \]
    Но, поскольку $\alpha_0 > 0$, при достаточно малых $t < 0$ справедливо
    \[ \alpha_0 + \frac{o(t)}{t} > 0, \]
    откуда следует, что в правой части равенства стоит строго отрицательная величина. 
    Получили противоречие.
\end{proof}

\begin{definition}
    Билинейная форма $\xi \colon X^2 \to \fieldr$ называется равномерно положительной (равномерно
    отрицательной), если существует такая константа $c > 0$, что для всех $h \in X$
    \[ \xi(h, h) \geq c \norm{h}^2 \]
    \[ (\xi(h, h) \leq -c \norm{h}^2). \]
\end{definition}

\begin{theorem}[достаточное условие экстремума]\hfill\\
    \indent Пусть $f \colon U \subset X \to \fieldr$ --- дважды дифференцируемая функция, 
    $f'(x_0) \hm= 0$
    и пусть $f''(x_0)$ --- равномерно отрицательная (равномерно положительная) билинейная форма.
    Тогда $x_0$ --- точка строгого локального максимума (минимума).
\end{theorem}

\begin{proof}
    Пусть, для определённости, $f''(x_0)$ равномерно отрицательна, 
    то есть существует такая константа $\alpha > 0$, что
    \[ f''(x_0)h^2 \leq -\alpha\norm{h^2}. \]
    Разложим функцию по формуле Тейлора в окрестности $x_0$:
    \[ f(x_0+h) = f(x_0) + f'(x_0)h + \frac{f''(x_0)h^2}{2} + o(\norm{h}^2). \]
    Поскольку $f'(x_0) = 0$,
    \[ f(x_0+h) - f(x_0) = \frac{f''(x_0)h^2}{2} + o(\norm{h}^2) \leq 
        -\frac{\alpha \norm{h}^2}{2} + o(\norm{h}^2). \]

    Найдется такое $\delta > 0$, что при всех $\norm{h} < \delta$ выполняется 
    неравенство $o(\norm{h}^2) \hm\leq (\alpha/4)\norm{h}^2$, поэтому
    \[ f(x_0+h) - f(x_0) \leq -\frac{\alpha \norm{h}^2}{2} + o(\norm{h}^2) \leq 
        -\frac{\alpha \norm{h}^2}{4} < 0 \]
    при $\norm{h} < \delta$. А это в точности и означает, что $x_0$ --- точка строгого 
    локального максимума. Аналогично рассматривается случай локального минимума.
\end{proof}
